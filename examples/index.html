<!DOCTYPE html>
<html>
<head>
<style>
.classy {
  color: lime;
}
.notty {
  color: red;
}
</style>

<script type="text/javascript" src="../src/treetests.js"></script>
<script type="text/javascript" src="../src/app.js"></script>
<script type="text/javascript" src="../src/templater.js"></script>
<script type="text/javascript" src="../src/dom_ele.js"></script>
<script type="text/javascript" src="../src/view.js"></script>
<script type="text/javascript">
window.addEventListener('load', function () {
temp_ele = document.getElementById('tt-category-controller');
temp_ele_cat_child = document.getElementById('tt-category-child');
out_ele = document.getElementById('wowee');

app = treetests.app();

app.add_template('cat-template', 'tt-category-controller');
app.add_template('tt-cat-child', 'tt-category-child');

test_tdata = {
  name: 'hoooeee wowzers',
  cat_passed: 22,
  cat_count: 22,
  children: [
  {
    type: 'category',
    name: 'yeppers',
    cat_passed: 20,
    cat_count: 20,
  },
  {
    name: 'yeppers 2',
    cat_passed: 10,
    cat_count: 20,
  },
  ]
};
app.add_controller('cat-cont', function () {
  this.set_model = function(model) {
    var test_data = model;
    this.cont_class = (test_data.cat_passed === test_data.cat_count && 'classy') || 'notty';
    this.children_cont_class = 'lil-classy';
  }
});
app.add_controller('fu-controller', function () {
  this.set_model = function(model) {
    var test_data = model;
    this.cont_class = (test_data.cat_passed < test_data.cat_count && 'classy') || 'notty';
    this.children_cont_class = 'lil-classy';
  }
});

app.inject('cat-template', out_ele);
});
</script>
</head>
<body>
<div id="tt-templates" style="display: none;">
  <div id="tt-category-controller" data-tt-controller="cat-cont" data-tt-model="test_tdata" data-tt-class="controller.cont_class">
    <div class="my_cat_title" data-tt-text="model.name"></div>
    <div class="my_cat_result">
      <span data-tt-text="model.cat_passed"></span> / <span data-tt-text="model.cat_count"></span>
      <tt-repeater data-tt-model="model.children" class="my_cat_children" data-tt-class="controller.children_cont_class">
        <tt-cat-child data-tt-skip="model.type === 'category'"></tt-cat-child>
        <tt-cat-child class="mmk" data-tt-skip="model.type !== 'category'"></tt-cat-child>
      </tt-repeater>
    </div>
  </div>

  <div id="tt-category-child" data-tt-class="controller.cont_class" data-tt-controller="fu-controller">
    <div data-tt-text="model.name + ' child'">
    </div>
  </div>
</div>
<div id="wowee">
</div>
</body>
</html>
